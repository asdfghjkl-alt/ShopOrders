(this["webpackJsonpstore-recording"]=this["webpackJsonpstore-recording"]||[]).push([[0],{18:function(e,t,a){"use strict";a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return p}));var n,r=a(4),c=a.n(r),o=a(11),l=a(12),s=a(0),u=a.n(s),i=a(17),m=a.n(i),p=u.a.createContext();function d(e){var t=Object(s.useState)(null),a=Object(l.a)(t,2),r=a[0],i=a[1],d=Object(s.useState)(),f=Object(l.a)(d,2),b=f[0],g=f[1],h=Object(s.useState)(""),E=Object(l.a)(h,2),v=E[0],O=E[1],y=Object(s.useState)(!1),S=Object(l.a)(y,2),k=S[0],N=S[1],x=Object(s.useCallback)(function(){var e=Object(o.a)(c.a.mark((function e(t,a,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i(a),O(t),r=n||new Date((new Date).getTime()+36e5),g(r),!a){e.next=9;break}return e.next=7,m.a.get("https://ed-shop-backend.herokuapp.com/users",{headers:{Authorization:"Bearer "+a}});case 7:!0===e.sent.data.admin?(N(!0),localStorage.setItem("userData",JSON.stringify({admin:!0,userId:t,token:a,expiration:r.toISOString()}))):localStorage.setItem("userData",JSON.stringify({userId:t,token:a,expiration:r.toISOString()}));case 9:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),[]),j=Object(s.useCallback)((function(){i(null),g(null),O(null),localStorage.removeItem("userData"),N(!1)}),[]);return Object(s.useEffect)((function(){if(r&&b){var e=b.getTime()-(new Date).getTime();n=setTimeout(j,e)}else clearTimeout(n)}),[r,j,b]),Object(s.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&new Date(e.expiration)>new Date&&x(e.userId,e.token,new Date(e.expiration))}),[x]),u.a.createElement(p.Provider,{value:{isLoggedIn:!!r,token:r,admin:k,userId:v,login:x,logout:j}},e.children)}p.Consumer},23:function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return d}));var n=a(34),r=a(4),c=a.n(r),o=a(11),l=a(12),s=a(0),u=a.n(s),i=a(17),m=a.n(i),p=a(18),d=u.a.createContext();function f(e){var t=Object(s.useState)([]),a=Object(l.a)(t,2),r=a[0],i=a[1],f=Object(s.useState)([]),b=Object(l.a)(f,2),g=b[0],h=b[1],E=Object(s.useContext)(p.a),v=Object(s.useCallback)(Object(o.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("https://ed-shop-backend.herokuapp.com/products");case 3:t=e.sent,i(t.data),a=localStorage.getItem("cart"),(a=JSON.parse(a))&&a.length>0?(h(a),localStorage.setItem("cart",JSON.stringify(a))):(h([]),localStorage.setItem("cart",JSON.stringify([]))),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),[]),O=function(){var e=Object(o.a)(c.a.mark((function e(t,a){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("https://ed-shop-backend.herokuapp.com//products/update/"+a.toString(),t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:v();case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,a){return e.apply(this,arguments)}}();function y(){return(y=Object(o.a)(c.a.mark((function e(t){var a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("cart"),a=JSON.parse(a),(n=a.findIndex((function(e){return e.productId._id.toString()===t._id.toString()})))<0||0===a.length?a.push({productId:t,quantity:1}):((r=a[n]).quantity+=1,a[n]=r),localStorage.setItem("cart",JSON.stringify(a)),h(a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(o.a)(c.a.mark((function e(t){var a,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("cart"),a=JSON.parse(a),(r=a.findIndex((function(e){return e.productId._id.toString()===t._id.toString()})))>-1&&((o=a[r]).quantity-=1,a[r]=o,0===o.quantity&&a.splice(r,1),localStorage.setItem("cart",JSON.stringify(a))),h(Object(n.a)(a));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){return(k=Object(o.a)(c.a.mark((function e(t){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=localStorage.getItem("cart"),a=JSON.parse(a),r=a.findIndex((function(e){return e.productId._id.toString()===t._id.toString()})),a.splice(r,1),localStorage.setItem("cart",JSON.stringify(a)),h(Object(n.a)(a));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(o.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.setItem("cart",JSON.stringify([])),h([]);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(s.useEffect)((function(){v()}),[E.login,E.token,E.isLoggedIn,v,g]),u.a.createElement(d.Provider,{value:{products:r,cart:g,addToCart:function(e){return y.apply(this,arguments)},decrement:function(e){return S.apply(this,arguments)},removeItem:function(e){return k.apply(this,arguments)},searchForData:v,removeAll:function(){return N.apply(this,arguments)},updateStock:O}},e.children)}d.Consumer},58:function(e,t,a){},59:function(e,t,a){e.exports=a(90)},83:function(e,t,a){},90:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(24),o=a.n(c),l=a(3),s=(a(64),a(15)),u=a(4),i=a.n(u),m=a(11),p=a(12),d=a(56),f=a(29),b=a(23),g=a(18),h=a(17),E=a.n(h);a(58),a(83);var v=function(){var e=Object(n.useContext)(b.a),t=0,a=Object(n.useContext)(g.a),c=Object(n.useState)({}),o=Object(p.a)(c,2),s=o[0],u=o[1];return e.cart.forEach((function(e){t+=e.quantity})),Object(n.useEffect)((function(){var e=function(){var e=Object(m.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.a.get("https://ed-shop-backend.herokuapp.com/users",{headers:{Authorization:"Bearer "+a.token}});case 2:t=e.sent,u(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();a.token?e():u({})}),[a]),r.a.createElement(f.a,{bg:"primary",varient:"dark",expand:"lg",className:"navbars"},r.a.createElement(l.b,{to:"/"},r.a.createElement("i",{className:"fas fa-leaf navbar-brand",style:{fontSize:"300%"}})),r.a.createElement(f.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(f.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(d.a,{className:"ml-5"},r.a.createElement(l.b,{to:"/fruit",className:"nav-link"},r.a.createElement("i",{className:"fas fa-apple-alt"})," Fruit"),r.a.createElement(l.b,{to:"/vegetables",className:"nav-link"},r.a.createElement("i",{className:"fas fa-lemon"})," Vegetables"),a.admin&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.b,{to:"/add",className:"nav-link",style:{color:"red"}},r.a.createElement("i",{className:"fas fa-plus",style:{color:"red"}})," ","Products add"),r.a.createElement(l.b,{to:"/users",className:"nav-link",style:{color:"red"}},r.a.createElement("i",{className:"fas fa-edit",style:{color:"red"}})," Users")),a.isLoggedIn&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.b,{to:"/useredit",className:"nav-link",style:{color:"red"}},r.a.createElement("i",{className:"fas fa-sign",style:{color:"red"}})," Users edit"),r.a.createElement(l.b,{to:"/getorders",className:"nav-link",style:{color:"green"}},r.a.createElement("i",{className:"fas fa-money-check-alt",style:{color:"green"}})," ","My Orders")))),r.a.createElement(l.b,{to:"/cart",className:"ml-auto"},r.a.createElement("button",{className:"button",style:{color:"yellow"}},s.name," Cart"," ",r.a.createElement("span",{className:"mr-2"},r.a.createElement("i",{className:"fa",style:{fontSize:"24px"}},"\uf07a"),r.a.createElement("span",{className:"badge badge-warning",id:"lblCartCount"}," ",t," ")))),a.isLoggedIn?r.a.createElement("p",null):r.a.createElement(l.b,{to:"/signup",className:"ml-auto"},r.a.createElement("button",{className:"button"},r.a.createElement("span",{className:"mr-2"},"Signup"))),a.isLoggedIn?r.a.createElement(l.b,{className:"ml-auto",to:"/"},r.a.createElement("button",{className:"button",onClick:a.logout,style:{color:"red"}},r.a.createElement("span",{className:"mr-2"},"Logout"))):r.a.createElement(l.b,{to:"/login",className:"ml-auto"},r.a.createElement("button",{className:"button"},r.a.createElement("span",{className:"mr-2"},"Login"))))},O=a(20),y=function(e){var t=e.component,a=Object(O.a)(e,["component"]);return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return localStorage.getItem("userData")?r.a.createElement(s.a,{to:"/"}):r.a.createElement(t,e)}}))},S=function(e){var t=e.component,a=Object(O.a)(e,["component"]);return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return localStorage.getItem("userData")?r.a.createElement(t,e):r.a.createElement(s.a,{to:"/signup"})}}))},k=function(e){var t=e.component,a=Object(O.a)(e,["component"]),n=JSON.parse(localStorage.getItem("userData"));return r.a.createElement(s.b,Object.assign({},a,{render:function(e){return n.admin?r.a.createElement(t,e):r.a.createElement(s.a,{to:"/"})}}))},N=r.a.lazy((function(){return a.e(13).then(a.bind(null,103))})),x=r.a.lazy((function(){return a.e(9).then(a.bind(null,110))})),j=r.a.lazy((function(){return a.e(5).then(a.bind(null,111))})),I=r.a.lazy((function(){return a.e(4).then(a.bind(null,104))})),w=r.a.lazy((function(){return a.e(11).then(a.bind(null,105))})),C=r.a.lazy((function(){return a.e(12).then(a.bind(null,106))})),J=r.a.lazy((function(){return a.e(3).then(a.bind(null,107))})),z=r.a.lazy((function(){return a.e(7).then(a.bind(null,112))})),D=r.a.lazy((function(){return a.e(6).then(a.bind(null,108))})),L=r.a.lazy((function(){return a.e(8).then(a.bind(null,109))})),T=r.a.lazy((function(){return a.e(10).then(a.bind(null,113))}));var _=function(){return r.a.createElement(l.a,null,r.a.createElement(v,null),r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(s.d,null,r.a.createElement(s.b,{path:"/",exact:!0,component:J}),r.a.createElement(s.b,{exact:!0,path:"/details/:detailproduct",component:N}),r.a.createElement(k,{exact:!0,path:"/add",component:j}),r.a.createElement(k,{exact:!0,path:"/users",component:z}),r.a.createElement(s.b,{exact:!0,path:"/cart",component:x}),r.a.createElement(S,{exact:!0,path:"/pay",component:L}),r.a.createElement(S,{exact:!0,path:"/useredit",component:D}),r.a.createElement(S,{exact:!0,path:"/getorders",component:T}),r.a.createElement(y,{exact:!0,path:"/signup",component:C}),r.a.createElement(y,{exact:!0,path:"/login",component:w}),r.a.createElement(s.b,{exact:!0,path:"/fruit",component:function(){return r.a.createElement(I,{value:"fruit"})}}),r.a.createElement(s.b,{exact:!0,path:"/vegetables",component:function(){return r.a.createElement(I,{value:"vegetable"})}}),r.a.createElement(s.a,{to:"/"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(g.b,null,r.a.createElement(b.b,null,r.a.createElement(l.a,null,r.a.createElement(_,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[59,1,2]]]);
//# sourceMappingURL=main.4efc2062.chunk.js.map